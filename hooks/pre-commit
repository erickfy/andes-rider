#!/bin/sh

echo "============================================="
echo "üöÄ Ejecutando pruebas de calidad antes del commit..."
echo "============================================="

# Detectar si usar mvnw (wrapper) o mvn global
# Validamos que existan tanto el ejecutable como su configuraci√≥n
if [ -f "./mvnw" ] && [ -f "./.mvn/wrapper/maven-wrapper.properties" ]; then
    EXECUTABLE="./mvnw"
else
    EXECUTABLE="mvn"
fi

echo "‚ÑπÔ∏è  Usando ejecutable: $EXECUTABLE"

# Ejecutar tests
$EXECUTABLE clean verify

# Capturar el c√≥digo de salida
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
    echo "============================================="
    echo "‚ùå ERROR: Las pruebas de calidad fallaron."
    echo "Corre los tests localmente y arr√©glalos antes de hacer commit."
    echo "============================================="
    exit 1
fi

echo "============================================="
echo "‚úÖ √âXITO: Las pruebas de calidad pasaron."
echo "============================================="
exit 0